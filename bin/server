#!/usr/bin/env node

/**
 * Module dependencies.
 */

var bodyParser = require('koa-bodyparser');
var PORT = process.env.PORT || 3000;
var logger = require('koa-logger');
var route = require('koa-route');
var koa = require('koa');
var parse = require('co-body');

/**
 * Expose `app`.
 */

module.exports = app = koa();
module.exports = route
module.exports = bodyParser

/**
 * Middleware.
 */

app.use(logger());
app.use(bodyParser());

/**
 * Configure routes.
 */

var routes = require('../server/routes.js');

app.use(route.get('/', routes.list));
app.use(route.get('/post/new', routes.add));
app.use(route.get('/post/:id', routes.show));
app.use(route.post('/post', routes.create));

/**
 * Listen on PORT.
 */

app.listen(PORT);
console.log('listening on port ' + PORT);
